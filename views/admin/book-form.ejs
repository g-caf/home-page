<%- include('../partials/head', { title: bookPost ? 'Edit Book Post' : 'Create Book Post' }) %>
<body class="admin-page">
    <%- include('../partials/header') %>

    <main class="admin-content">
        <div class="form-header">
            <h1><%= bookPost ? 'Edit Book Post' : 'Create New Book Post' %></h1>
            <a href="/admin" class="btn-back">Back to Admin</a>
        </div>

        <% if (error) { %>
            <div class="error-message"><%= error %></div>
        <% } %>

        <form action="<%= bookPost ? `/admin/${bookPost.id}` : '/admin' %>" method="POST" enctype="multipart/form-data" class="book-form">
            <div class="form-group">
                <label for="type">Type *</label>
                <select id="type" name="type" required>
                    <option value="book" <%= (bookPost && bookPost.type === 'book') || !bookPost ? 'selected' : '' %>>Book Post</option>
                    <option value="page" <%= bookPost && bookPost.type === 'page' ? 'selected' : '' %>>Page</option>
                </select>
            </div>

            <div class="form-group">
                <label for="title">Title *</label>
                <input type="text" id="title" name="title" required value="<%= bookPost ? bookPost.title : '' %>">
            </div>

            <div class="form-group">
                <label for="subtitle">Subtitle</label>
                <input type="text" id="subtitle" name="subtitle" value="<%= bookPost ? (bookPost.subtitle || '') : '' %>">
            </div>

            <div class="form-group">
                <label for="published_date">Published Date *</label>
                <input type="date" id="published_date" name="published_date" required value="<%= bookPost ? (bookPost.published_date instanceof Date ? bookPost.published_date.toISOString().split('T')[0] : bookPost.published_date.split('T')[0]) : '' %>">
            </div>

            <div class="form-group">
                <label for="content">Content</label>
                <textarea id="content" name="content" rows="10"><%= bookPost ? (bookPost.content || '') : '' %></textarea>
            </div>

            <div class="form-group">
                <label for="image">Cover Image</label>
                <% if (bookPost && bookPost.image_url) { %>
                    <div class="current-image">
                        <img src="<%= bookPost.image_url %>" alt="Current cover" style="max-width: 200px; margin-bottom: 10px;">
                        <p>Upload a new image to replace the current one</p>
                    </div>
                <% } %>
                <input type="file" id="image" name="image" accept="image/*">
                <p class="form-help">Accepted formats: JPEG, JPG, PNG, GIF, WebP (Max 5MB)</p>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-submit"><%= bookPost ? 'Update Post' : 'Create Post' %></button>
                <a href="/admin" class="btn-cancel">Cancel</a>
            </div>
        </form>
    </main>

    <%- include('../partials/footer') %>
</body>
